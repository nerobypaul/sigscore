# Changelog — 2026-02-19

## 10:15 — UX audit and high-impact fixes

**Task:** Comprehensive UX audit across nav, forms, integrations, and tables — then fix the highest-impact issues

**Audit Findings (3 parallel agents):**
- Nav/page flow: Settings section collapsed by default hiding key features
- Integrations: Marketplace and Settings are disconnected — 12 integrations have Settings setup but marketplace shows dead "coming soon" fields
- Forms/tables: Deal form defaults to wrong stage, ScoringBuilder delete has no confirmation, contact form grids break on mobile

**Changes:**
- Layout.tsx — Settings section now expanded by default (was collapsed, hiding Integrations, Billing, Team, etc.)
- Deals.tsx — Deal creation form default stage changed from ANONYMOUS_USAGE to IDENTIFIED (the first real pipeline stage for creating deals manually)
- ScoringBuilder.tsx — Added confirmation dialog before deleting scoring rules (was instant, no undo)
- Contacts.tsx — Fixed 2 form grids to be responsive (grid-cols-1 sm:grid-cols-2 instead of just grid-cols-2)
- IntegrationDetail.tsx — Added SETTINGS_TAB_MAP for 12 integrations with Settings setup flows; "not connected" state now shows "Configure in Settings" CTA linking to `/settings?tab={id}` instead of disabled fields with "coming soon"
- Settings.tsx — Added URL query parameter support (`?tab=hubspot`) so IntegrationDetail deep-links work

**Decisions:**
- Chose IDENTIFIED over ANONYMOUS_USAGE as default deal stage because manual deal creation implies a known contact
- Kept marketplace "not connected" view for integrations without Settings tabs (npm, PyPI, GitHub, etc.) — those show config fields as disabled with "coming soon via API" messaging
- Used window.confirm() for ScoringBuilder delete (consistent with existing confirm patterns across the app)

**Status:** completed

## 14:30 — Visual audit system + frontend bug fixes

**Task:** Build a Playwright visual audit system to screenshot all 51 pages, then analyze and fix bugs found through visual inspection

**Visual Audit System:**
- Built `scripts/visual-audit.ts` — Playwright script that captures 51 screenshots across desktop/mobile, public/authenticated pages
- Direct API demo seed (POST /api/v1/demo/seed) instead of UI button click for reliable auth
- Token injection via `addInitScript()` with rotation-safe logic (only sets if not present)
- Dismisses overlays (cookie consent, onboarding tour, setup checklist) via correct storage keys

**Bugs Found & Fixed:**
- SignalFeed.tsx — Debounce `useEffect` called `setSignals([])` 400ms after mount, wiping already-loaded data. Removed the state reset from debounce (fetchSignals handles it via buildParams dependency)
- Signals.tsx — Read `data.data` but backend returns `data.signals`. Fixed response key
- PQADashboard.tsx — Called `/signals/top-accounts` but route is `/signals/accounts/top` (404). Also read `data.data` but backend returns `data.accounts`. Fixed both URL and response key
- vite.config.ts — Proxy targeted port 3000 but backend runs on 3001. Fixed to `process.env.VITE_API_TARGET || 'http://localhost:3001'`

**Verification:**
- Signal Feed: now shows 395 signals with proper grouping and metadata
- PQA Scores: now shows 8 scored accounts, tier distribution chart, trend summary
- Dashboard, Contacts, Companies, Deals all render correctly

**Decisions:**
- Used fallback pattern (`data.signals || data.data || []`) for backwards compatibility with any API response shape changes
- Made vite proxy port configurable via VITE_API_TARGET env var for deployment flexibility

**Status:** completed
